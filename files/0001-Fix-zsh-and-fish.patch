From 899752abb415d56bfd3b2cc2add8f89183f2ea40 Mon Sep 17 00:00:00 2001
From: Troy Harvey <harveydevel@gmail.com>
Date: Tue, 20 Jun 2023 18:07:12 +1000
Subject: [PATCH] Fix zsh and fish

Signed-off-by: Troy Harvey <harveydevel@gmail.com>
---
 data/scripts/Xsession        | 3 ++-
 data/scripts/wayland-session | 3 ++-
 2 files changed, 4 insertions(+), 2 deletions(-)

diff --git a/data/scripts/Xsession b/data/scripts/Xsession
index 5449810..27f8887 100755
--- a/data/scripts/Xsession
+++ b/data/scripts/Xsession
@@ -21,7 +21,7 @@ case $SHELL in
     ;;
 */zsh)
     [ -z "$ZSH_NAME" ] && exec $SHELL $0 "$@"
-    [ -d /etc/zsh ] && zdir=/etc/zsh || zdir=/etc
+    [ -d /usr/share/defaults/etc/zsh ] && zdir=/usr/share/defaults/etc/zsh
     zhome=${ZDOTDIR:-$HOME}
     # zshenv is always sourced automatically.
     [ -f $zdir/zprofile ] && . $zdir/zprofile
@@ -39,6 +39,7 @@ case $SHELL in
     rm -f $xsess_tmp
     ;;
   */fish)
+    [ -f /usr/share/defaults/etc/profile ] && . /usr/share/defaults/etc/profile
     xsess_tmp=`mktemp /tmp/xsess-env-XXXXXX`
     $SHELL --login -c "/bin/sh -c 'export -p' > $xsess_tmp"
     . $xsess_tmp
diff --git a/data/scripts/wayland-session b/data/scripts/wayland-session
index de4f519..0d79498 100755
--- a/data/scripts/wayland-session
+++ b/data/scripts/wayland-session
@@ -21,7 +21,7 @@ case $SHELL in
     ;;
 */zsh)
     [ -z "$ZSH_NAME" ] && exec $SHELL $0 "$@"
-    [ -d /etc/zsh ] && zdir=/etc/zsh || zdir=/etc
+    [ -d /usr/share/defaults/etc/zsh ] && zdir=/usr/share/defaults/etc/zsh
     zhome=${ZDOTDIR:-$HOME}
     # zshenv is always sourced automatically.
     [ -f $zdir/zprofile ] && . $zdir/zprofile
@@ -39,6 +39,7 @@ case $SHELL in
     rm -f $wlsess_tmp
     ;;
   */fish)
+    [ -f /usr/share/defaults/etc/profile ] && . /usr/share/defaults/etc/profile
     xsess_tmp=`mktemp /tmp/xsess-env-XXXXXX`
     $SHELL --login -c "/bin/sh -c 'export -p' > $xsess_tmp"
     . $xsess_tmp
-- 
2.40.1

